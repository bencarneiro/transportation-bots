
   
{% load static %}
<html>
    <fieldset id="local">
    {% for key in local_routes %} 
    <input type="checkbox" id="{{key.route_id__route_id|safe}}" name={{key.route_id__route_id|safe}} unchecked>
    <label for="scales">{{key.route_id__route_long_name}}</label>
  {% endfor %}
</fieldset>
<fieldset>
    <legend>Choose your monster's features:</legend>

    <div>
      <input type="checkbox" id="scales" name="scales" checked>
      <label for="scales">Scales</label>
    </div>

    <div>
      <input type="checkbox" id="horns" name="horns">
      <label for="horns">Horns</label>
      <div id="otherValue"></div>
    </div>
</fieldset>


 <div style="width: 100%;"><canvas id="chart"></canvas></div>



 <script>
    var localRouteArray = []
    const otherCheckbox = document.querySelector("#horns");
    const otherText = document.querySelector("#otherValue");
    otherText.style.visibility = "hidden";
    
    const localRoutes = document.querySelector("#local");

    localRoutes.addEventListener("change", (event) => {
    if (!localRouteArray.includes(event.target.id)) {
        localRouteArray.push(event.target.id)
    } else {
        localRouteArray = localRouteArray.filter(item => item !== event.target.id)
    }
    console.log(localRouteArray)
});

otherCheckbox.addEventListener("change", () => {
  if (otherCheckbox.checked) {
    otherText.style.visibility = "visible";
    otherText.value = "";
  } else {
    otherText.style.visibility = "hidden";
  }
});


 </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>

 
    <script>
        const pmtByMode = axios.get("/monthly_ridership/?route_id=7").then((resp) => {
            const chart = new Chart(
                document.getElementById('chart'),
                {
                    type: 'line',
                    options: {
                        tooltips: {
                        callbacks: {
                            label: function(tooltipItem, data) {
                                return (
                                    new Intl.NumberFormat("en-US", {
                                        notation: "compact",
                                        compactDisplay: "short",
                                        }).format(tooltipItem.yLabel)
                                )
                            }
                        }
                    },
                        scales: {
                            yAxes: [{
                                ticks: {
                                    // Include a dollar sign in the ticks
                                    callback: function(value, index, ticks) {
                                        return (
                                            new Intl.NumberFormat("en-US", {
                                                notation: "compact",
                                                compactDisplay: "short",
                                                }).format(value)
                                        )
                                    }
                                }
                            }]
                        }
                    },
                    data: 
                    {
                        labels: resp.data.data.map(row => row.date),
                        datasets: [
                        {
                            label: 'Bus',
                            data: resp.data.data.map(row => row.riders),
                            backgroundColor: "green",
                            borderColor: "black"
                        },
                        ]
                    }
                }
            )
        })
    </script>
    </html>